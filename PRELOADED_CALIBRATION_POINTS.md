# 🎯 预加载校准点功能

## 📋 功能概述

校准页面现在**预加载了6个校准点**，用户可以：
1. 直接进行坐标转换测试
2. 查看和编辑预设的校准点
3. 添加新的校准点
4. 重置为默认校准点

## 🔧 预加载的校准点数据

### 校准点列表

| 点名称 | 模型坐标 (X, Z) | 经纬度 | 颜色 |
|--------|----------------|--------|------|
| 校准点1 | (-72.40, 812.98) | (31.242242, 121.491427) | 🔴 红色 |
| 校准点2 | (106.20, 796.42) | (31.244036, 121.490378) | 🟢 绿色 |
| 校准点3 | (-71.62, 411.38) | (31.240711, 121.486782) | 🔵 蓝色 |
| 校准点4 | (-3.91, 176.28) | (31.240478, 121.483794) | 🟡 黄色 |
| 校准点5 | (-292.64, 403.93) | (31.238495, 121.487661) | 🟣 紫色 |
| 校准点6 | (-288.37, 160.31) | (31.237553, 121.484886) | 🔵 青色 |

### 校准范围

**模型坐标范围**：
- X轴: -292.64 ~ 106.20 (范围: 398.84)
- Z轴: 160.31 ~ 812.98 (范围: 652.67)

**地理坐标范围**：
- 纬度: 31.237553 ~ 31.244036 (范围: 0.006483°)
- 经度: 121.483794 ~ 121.491427 (范围: 0.007633°)

## 🎮 使用方法

### 1. 直接测试（推荐）
1. 打开校准页面 `/calibration`
2. 页面自动加载6个校准点
3. 等待1秒后自动计算转换参数
4. 使用"坐标转换测试"功能测试任意经纬度

### 2. 查看预设校准点
- 在"校准点列表"中查看所有预加载的点
- 每个点都包含完整的模型坐标和经纬度信息
- 可以编辑任意校准点的信息

### 3. 添加新校准点
- 在3D模型上点击选择新位置
- 点击"添加校准点"
- 编辑新点的经纬度信息
- 重新计算转换参数

### 4. 管理校准点
- **重置为默认点**: 恢复到预设的6个校准点
- **清空所有点**: 删除所有校准点，从头开始
- **导出校准数据**: 保存当前校准结果

## 🧪 测试示例

### 快速测试坐标

**测试坐标**: `(31.2382, 121.486697)`

**预期结果**（使用修正后的算法）：
- 模型坐标: 约 `(-286.64, 0, 319.84)`
- 热力图坐标: 约 `(4, 189)`
- 转换误差: < 10米
- 在校准范围内: 是

### 验证步骤
1. 在"坐标转换测试"中输入上述坐标
2. 点击"转换"按钮
3. 查看结果是否与预期一致
4. 检查反向验证是否通过

## 🔍 技术细节

### 自动计算
- 页面加载后1秒自动计算转换参数
- 使用修正后的仿射变换逆运算公式
- 自动显示转换精度和边界信息

### 数据来源
- 校准点数据来自 `fbx-coordinate-calibration-2025-08-08.json`
- 包含6个经过验证的高精度校准点
- 覆盖了模型的主要区域

### 算法改进
- 修正了仿射变换逆运算的数学错误
- 使用克拉默法则正确求解线性方程组
- 提供详细的精度验证和误差分析

## 🎯 优势

### 1. 即开即用
- 无需手动添加校准点
- 自动计算转换参数
- 直接进行坐标测试

### 2. 高精度
- 6个精心选择的校准点
- 覆盖模型主要区域
- 平均误差约2.7米

### 3. 灵活性
- 可以编辑预设校准点
- 可以添加新的校准点
- 可以重置为默认状态

### 4. 便于调试
- 提供详细的转换结果
- 包含反向验证
- 显示误差分析

## 📱 界面改进

### 顶部信息栏
- 显示"已预加载6个校准点"徽章
- 提示可直接测试坐标转换
- 清晰的功能说明

### 快速开始指南
- 突出显示的快速开始部分
- 简化的使用步骤
- 重点强调预加载功能

### 按钮布局
- 新增"重置为默认点"按钮
- 优化按钮排列和颜色
- 清晰的功能分组

## 🔄 工作流程

```
页面加载
    ↓
自动加载6个校准点
    ↓
1秒后自动计算转换参数
    ↓
显示转换结果和精度
    ↓
用户可直接测试坐标转换
```

## 📈 后续计划

1. **批量测试**: 支持CSV文件批量测试多个坐标
2. **可视化**: 在3D模型上高亮显示校准点
3. **精度优化**: 根据使用反馈调整校准点位置
4. **模板管理**: 支持保存和加载不同的校准模板

---

**使用建议**: 新用户可以直接使用预加载的校准点进行测试，验证系统功能后再根据需要添加或调整校准点。
