# 人群仿真可视化系统 - 快速使用指南

## 🚀 快速开始

### 1. 项目启动
```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build
```

### 2. 访问系统
- **原有功能**: http://localhost:3000/ (上海建筑物3D展示)
- **新增功能**: http://localhost:3000/simulation (人群仿真可视化)

## 📱 主要功能

### 🏙️ 3D场景展示
- **建筑物模型**: 上海城市建筑FBX模型展示
- **热力图**: 3D热力图渲染，支持实时数据更新
- **人群轨迹**: 动态轨迹线条，展示人群移动路径
- **密度可视化**: 3D球体表示人群密度分布

### 📊 数据可视化
- **折线图**: 显示人群密度随时间变化
- **环形图**: 显示区域人群分布比例
- **实时更新**: 图表数据自动刷新
- **交互功能**: 鼠标悬停显示详细数据

### ⚙️ 任务管理
- **任务创建**: 新建仿真任务，配置参数
- **任务监控**: 实时查看任务执行状态和进度
- **任务控制**: 开始、暂停、删除任务操作
- **结果查看**: 查看已完成任务的仿真结果

### 🔧 系统设置
- **渲染设置**: 图形质量、抗锯齿、阴影等
- **仿真参数**: 人群数量、时间步长、物理引擎
- **可视化选项**: 热力图分辨率、轨迹点数等
- **性能优化**: 内存限制、GPU加速、多线程

## 🎮 操作指南

### 3D场景控制
| 操作 | 快捷键/方式 | 说明 |
|------|------------|------|
| 旋转视角 | 鼠标左键拖拽 | 围绕目标旋转相机 |
| 缩放 | 鼠标滚轮 | 拉近/拉远视角 |
| 平移 | 鼠标右键拖拽 | 平移相机位置 |
| 重置视角 | 点击"重置视角"按钮 | 恢复默认相机位置 |

### 仿真播放控制
| 操作 | 按钮 | 说明 |
|------|------|------|
| 播放/暂停 | ▶️/⏸️ | 控制仿真动画播放 |
| 重置 | 🔄 | 重置仿真到初始状态 |
| 时间轴 | 拖拽滑块 | 跳转到指定时间点 |

### 数据筛选
1. **事件选择**: 下拉菜单选择不同仿真事件
2. **时间范围**: 设置开始和结束时间
3. **显示选项**: 切换轨迹、密度、流场显示

## 📈 数据格式

### 仿真事件数据
```typescript
{
  id: "event_001",
  name: "地铁站高峰期",
  type: "crowd_simulation",
  status: "completed",
  date: "2024-12-19",
  participants: 500,
  duration: 120
}
```

### 参与者数据
```typescript
{
  id: "participant_1",
  position: [x, y, z],
  velocity: [vx, vy, vz],
  timestamp: 1640000000000,
  metadata: {
    age: 25,
    group: 1
  }
}
```

### 热力图数据
```typescript
{
  x: 128,           // 像素X坐标
  y: 128,           // 像素Y坐标
  value: 8.5,       // 强度值 (0-10)
  timestamp: 1640000000000
}
```

## 🎨 界面说明

### 主要区域布局
```
┌─────────────────────────────────────┐
│              顶部导航栏               │
├─────────────────┬───────────────────┤
│                 │   可视化选项       │
│    3D场景区域    ├───────────────────┤
│                 │                   │
│                 │   数据图表区域     │
└─────────────────┴───────────────────┤
│              状态栏                 │
└─────────────────────────────────────┘
```

### 状态指示器
- 🟢 **已连接**: 系统正常运行
- 🟡 **连接中**: 正在建立连接
- 🔴 **已断开**: 网络或服务异常

### 任务状态
- **等待中**: 任务已创建，等待执行
- **运行中**: 任务正在执行，显示进度条
- **已完成**: 任务成功完成，可查看结果
- **失败**: 任务执行失败，检查错误信息

## 🛠️ 高级功能

### 自定义数据源
1. 实现 `DataSource` 接口
2. 调用 `simulationService.registerDataSource()` 注册
3. 在设置中配置连接参数

### 导出功能
- **JSON格式**: 完整数据结构导出
- **CSV格式**: 表格数据导出，便于Excel分析
- **图片格式**: 截图保存当前3D场景

### 性能调优
1. **内存监控**: 实时显示JavaScript内存使用
2. **帧率显示**: 开启FPS计数器
3. **LOD优化**: 距离远的对象使用低精度模型
4. **批量渲染**: 合并相似对象减少绘制调用

## 🔍 故障排除

### 常见问题及解决方案

#### 模型加载失败
```
问题: 3D模型不显示或加载错误
解决:
1. 检查 public/plugins/digitalCity/model/shanghai.FBX 文件是否存在
2. 确认文件权限和网络访问
3. 查看浏览器控制台的错误信息
```

#### 热力图不显示
```
问题: 热力图区域空白或渲染异常
解决:
1. 检查浏览器WebGL支持: chrome://gpu/
2. 更新显卡驱动程序
3. 降低热力图分辨率设置
```

#### 图表数据异常
```
问题: 折线图/环形图显示空白或数据错误
解决:
1. 检查数据格式是否正确
2. 确认图表容器尺寸不为0
3. 查看控制台是否有JavaScript错误
```

#### 性能问题
```
问题: 页面卡顿、帧率低下
解决:
1. 降低参与者数量和渲染质量
2. 关闭不必要的视觉效果
3. 启用GPU硬件加速
4. 增加系统内存和显存
```

### 调试模式
1. 在设置页面启用"调试模式"
2. 打开浏览器开发者工具
3. 查看Console面板的详细日志
4. 使用Performance面板分析性能瓶颈

## 📞 技术支持

### 获取帮助
- **文档**: README_SIMULATION.md (详细API文档)
- **依赖**: DEPENDENCIES.md (库文件清单)
- **源码**: src/pages/simulation.vue (主要代码)

### 联系方式
- **问题反馈**: GitHub Issues
- **功能建议**: GitHub Discussions
- **紧急支持**: 项目维护者邮箱

### 开发者资源
- **组件文档**: src/components/simulationVis/
- **数据服务**: src/common/simulationService.ts
- **样式系统**: 基于科技风格的CSS设计
- **工具函数**: simulationUtils 工具库

## 🚀 快速体验

### 演示场景
1. **地铁站高峰期**: 500人群仿真，展示拥挤场景
2. **商场疏散演练**: 800人疏散仿真，展示紧急情况
3. **体育场散场**: 2000人大规模仿真，展示复杂流动

### 推荐流程
1. 访问系统主页，点击"人群仿真可视化"
2. 选择"地铁站高峰期"事件
3. 观察3D场景中的人群动态
4. 查看右侧的实时数据图表
5. 尝试调整显示选项和时间范围
6. 体验任务管理和系统设置功能

恭喜！您已经完成了人群仿真可视化系统的快速入门。开始探索更多高级功能吧！ 🎉
